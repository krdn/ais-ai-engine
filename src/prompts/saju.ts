/**
 * ì‚¬ì£¼ ë¶„ì„ ì „ë¬¸ í”„ë¡¬í”„íŠ¸ ì •ì˜
 *
 * í•™ìƒ í•™ì—… í–¥ìƒ ì‚¬ì£¼ ë¶„ì„ í”„ë¡¬í”„íŠ¸ 5ì¢… + ê¸°ë³¸ í”„ë¡¬í”„íŠ¸
 */

import { SAJU_INTERPRETATION_PROMPT } from "./base.js"
import type { SajuResult } from "@ais/analysis"

// ---------------------------------------------------------------------------
// íƒ€ì… ì •ì˜
// ---------------------------------------------------------------------------

export type AnalysisPromptId =
  | "default"
  | "learning-dna"
  | "exam-slump"
  | "career-navi"
  | "subject-strategy"
  | "mental-energy"

export type AnalysisPromptMeta = {
  id: AnalysisPromptId
  name: string
  shortDescription: string
  target: string
  levels: string
  purpose: string
  recommendedTiming: string
  tags: string[]
}

export type StudentInfo = {
  birthDate: string       // YYYY-MM-DD
  birthTime: string       // "HH:MM" ë˜ëŠ” "ë¯¸ìƒ"
  gender?: string         // "ë‚¨" | "ì—¬" | undefined
  grade?: number          // í•™ë…„ (ì˜ˆ: 1~6, ì¤‘1=7, ê³ 1=10 ë“±)
  school?: string         // í•™êµëª…
  targetMajor?: string    // í¬ë§ í•™ê³¼/ë¶„ì•¼
}

export type AnalysisPromptDefinition = {
  meta: AnalysisPromptMeta
  buildPrompt: (sajuResult: SajuResult, studentInfo?: StudentInfo, additionalRequest?: string) => string
}

// ---------------------------------------------------------------------------
// í•™ë…„ í‘œì‹œ í—¬í¼
// ---------------------------------------------------------------------------

function formatGrade(grade?: number): string {
  if (!grade) return "ë¯¸ì…ë ¥"
  return `${grade}í•™ë…„`
}

// ---------------------------------------------------------------------------
// í•™ìƒ ì •ë³´ í¬ë§· í—¬í¼
// ---------------------------------------------------------------------------

function formatStudentInfo(info?: StudentInfo): string {
  if (!info) {
    return `â€¢ ìƒë…„ì›”ì¼: ë¯¸ì…ë ¥
â€¢ íƒœì–´ë‚œ ì‹œê°„: ë¯¸ì…ë ¥
â€¢ ì„±ë³„: ë¯¸ì…ë ¥
â€¢ í˜„ì¬ í•™ë…„: ë¯¸ì…ë ¥`
  }
  return `â€¢ ìƒë…„ì›”ì¼: ${info.birthDate}
â€¢ íƒœì–´ë‚œ ì‹œê°„: ${info.birthTime}
â€¢ ì„±ë³„: ${info.gender ?? "ë¯¸ì…ë ¥"}
â€¢ í˜„ì¬ í•™ë…„: ${formatGrade(info.grade)}${info.school ? ` (${info.school})` : ''}${info.targetMajor ? `\nâ€¢ ê´€ì‹¬ ë¶„ì•¼/í¬ë§ í•™ê³¼: ${info.targetMajor}` : ''}`
}

// ---------------------------------------------------------------------------
// ì‚¬ì£¼ ë°ì´í„° í¬ë§· í—¬í¼
// ---------------------------------------------------------------------------

function formatSajuData(r: SajuResult): string {
  const hourPillar = r.pillars.hour
    ? `${r.pillars.hour.stem}${r.pillars.hour.branch}`
    : "ë¯¸ìƒ"

  return `
**ì‚¬ì£¼ êµ¬ì¡° (å››æŸ±):**
- ì—°ì£¼(å¹´æŸ±): ${r.pillars.year.stem}${r.pillars.year.branch}
- ì›”ì£¼(æœˆæŸ±): ${r.pillars.month.stem}${r.pillars.month.branch}
- ì¼ì£¼(æ—¥æŸ±): ${r.pillars.day.stem}${r.pillars.day.branch}
- ì‹œì£¼(æ™‚æŸ±): ${hourPillar}

**ì˜¤í–‰ ë¶„í¬ (äº”è¡Œ):**
- ëª©(æœ¨): ${r.elements['ëª©'] ?? 0}
- í™”(ç«): ${r.elements['í™”'] ?? 0}
- í† (åœŸ): ${r.elements['í† '] ?? 0}
- ê¸ˆ(é‡‘): ${r.elements['ê¸ˆ'] ?? 0}
- ìˆ˜(æ°´): ${r.elements['ìˆ˜'] ?? 0}

**ì‹­ì„± ê´€ê³„ (åæ˜Ÿ):**
- ì—°ì£¼ ì‹­ì„±: ${r.tenGods.year}
- ì›”ì£¼ ì‹­ì„±: ${r.tenGods.month}
${r.tenGods.hour ? `- ì‹œì£¼ ì‹­ì„±: ${r.tenGods.hour}` : ''}`.trim()
}

// ---------------------------------------------------------------------------
// ì¶”ê°€ ìš”ì²­ì‚¬í•­ ê²°í•© í—¬í¼
// ---------------------------------------------------------------------------

function appendAdditionalRequest(prompt: string, additionalRequest?: string): string {
  if (!additionalRequest?.trim()) return prompt
  return `${prompt}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[ë¶„ì„ì ì¶”ê°€ ìš”ì²­/íŠ¹ì´ì‚¬í•­]
${additionalRequest.trim()}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ìœ„ ì¶”ê°€ ìš”ì²­ì‚¬í•­ì„ ë°˜ë“œì‹œ ë¶„ì„ ê²°ê³¼ì— ë°˜ì˜í•´ì£¼ì„¸ìš”.`
}

// ---------------------------------------------------------------------------
// í”„ë¡¬í”„íŠ¸ ì •ì˜
// ---------------------------------------------------------------------------

const PROMPT_DEFINITIONS: Record<AnalysisPromptId, AnalysisPromptDefinition> = {
  default: {
    meta: {
      id: "default",
      name: "ê¸°ë³¸ í•´ì„",
      shortDescription: "ì¢…í•©ì ì¸ ì‚¬ì£¼ í•´ì„",
      target: "ì „ì²´ í•™ìƒ",
      levels: "ê¸°ë³¸",
      purpose: "ì‚¬ì£¼ì˜ ì „ë°˜ì ì¸ íŠ¹ì„±ê³¼ ì ì¬ë ¥ì„ ì¢…í•©ì ìœ¼ë¡œ í•´ì„í•©ë‹ˆë‹¤.",
      recommendedTiming: "ì²« ìƒë‹´, ì¼ë°˜ ìƒë‹´",
      tags: ["ì¢…í•©", "ê¸°ë³¸"],
    },
    buildPrompt: (sajuResult, _studentInfo, additionalRequest) =>
      appendAdditionalRequest(SAJU_INTERPRETATION_PROMPT(sajuResult), additionalRequest),
  },

  "learning-dna": {
    meta: {
      id: "learning-dna",
      name: "í•™ìŠµ ì²´ì§ˆ ì‚¬ì£¼ ì§„ë‹¨ì„œ",
      shortDescription: "íƒ€ê³ ë‚œ í•™ìŠµ DNAë¥¼ íŒŒì•…í•˜ê³  ì²´ì§ˆì— ë§ëŠ” ìµœì ì˜ ê³µë¶€ë²•Â·ì‹œê°„ëŒ€Â·í™˜ê²½ì„ ì„¤ê³„",
      target: "í•™ìƒ ë³¸ì¸ (ì¤‘Â·ê³ ë“±í•™ìƒ)",
      levels: "â˜…â˜…â˜…â˜†â˜† (ì…ë¬¸~ì¤‘ê¸‰)",
      purpose: "ì‚¬ì£¼ ì˜¤í–‰Â·ì¼ê°„ ë¶„ì„ìœ¼ë¡œ íƒ€ê³ ë‚œ í•™ìŠµ DNAë¥¼ íŒŒì•…í•˜ê³ , ì²´ì§ˆì— ë§ëŠ” ìµœì ì˜ ê³µë¶€ë²•Â·ì‹œê°„ëŒ€Â·í™˜ê²½ì„ ì„¤ê³„í•œë‹¤",
      recommendedTiming: "í•™ê¸° ì´ˆ, ìƒˆ í•™ë…„ ì‹œì‘ ì „, í•™ìŠµ ë°©ë²•ì„ ë°”ê¾¸ê³  ì‹¶ì„ ë•Œ",
      tags: ["í•™ìŠµ", "ì²´ì§ˆ", "ê³µë¶€ë²•", "ì‹œê°„ëŒ€", "í™˜ê²½"],
    },
    buildPrompt: (sajuResult, studentInfo, additionalRequest) => appendAdditionalRequest(`
ì—­í• :
ë‹¹ì‹ ì€ ì‚¬ì£¼ëª…ë¦¬í•™ 30ë…„ ê²½ë ¥ì˜ í•™ì—… ì „ë¬¸ ìƒë‹´ì‚¬ì´ë©°,
í•œêµ­ ì¤‘Â·ê³ ë“±í•™êµ êµìœ¡ê³¼ì •ê³¼ í•™ìŠµì‹¬ë¦¬í•™ì— ì •í†µí•©ë‹ˆë‹¤.
ì‚¬ì£¼ ë¶„ì„ì„ í†µí•´ í•™ìƒì´ ìê¸° ìì‹ ì„ ê¹Šì´ ì´í•´í•˜ê³ ,
ìì‹ ì—ê²Œ ë§ëŠ” ê³µë¶€ë²•ì„ ì°¾ì•„ í•™ì—… ìì‹ ê°ì„ ë†’ì´ë„ë¡ ë•ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

[í•™ìƒ ì •ë³´]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatStudentInfo(studentInfo)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[í•™ìƒ ì‚¬ì£¼ ë°ì´í„°]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatSajuData(sajuResult)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ë¶„ì„ ìš”ì²­ í•­ëª©:

1. ì‚¬ì£¼ ì›êµ­ ì„¸ìš°ê¸°
   â”€ ë…„ì£¼Â·ì›”ì£¼Â·ì¼ì£¼Â·ì‹œì£¼ í•œì ë° í•œê¸€ í‘œê¸°
   â”€ ì²œê°„Â·ì§€ì§€ ë„í‘œ ì‘ì„±
   â”€ ì˜¤í–‰(ëª©Â·í™”Â·í† Â·ê¸ˆÂ·ìˆ˜) ë¶„í¬ ë¹„ìœ¨ì„ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„
   â”€ ì‹œì£¼ ë¯¸ìƒ ì‹œ, ê°€ëŠ¥í•œ ë²”ìœ„ ë‚´ì—ì„œ ë¶„ì„í•˜ê³  í•œê³„ë¥¼ ëª…ì‹œ

2. ì¼ê°„(æ—¥å¹²) ê¸°ë°˜ í•™ìŠµ ì„±í–¥ í”„ë¡œíŒŒì¼
   â”€ ì¼ê°„ì˜ ì˜¤í–‰ ì†ì„±ì´ í•™ìŠµì— ë¯¸ì¹˜ëŠ” ì˜í–¥
   â”€ 4ê°€ì§€ í•™ìŠµ ì—­ëŸ‰ ë¶„ì„:
     â€¢ ì§‘ì¤‘ë ¥ (í•œ ê³¼ëª© ê¹Šì´ íŒŒê¸° vs ë©€í‹°íƒœìŠ¤í‚¹)
     â€¢ ê¸°ì–µë ¥ (ë°˜ë³µ ì•”ê¸°í˜• vs ì´í•´ ê¸°ì–µí˜•)
     â€¢ ë…¼ë¦¬ë ¥ (ìˆ˜ë¦¬Â·ë¶„ì„ ì ì„±)
     â€¢ ì°½ì˜ë ¥ (ë°œì‚°ì  ì‚¬ê³ Â·ì‘ìš©ë ¥)
   â”€ ê° ì—­ëŸ‰ì„ ìƒÂ·ì¤‘Â·í•˜ë¡œ í‰ê°€í•˜ê³  ê·¼ê±° ì œì‹œ
   â”€ "ë‚˜ëŠ” ì´ëŸ° í•™ìŠµìë‹¤"ë¥¼ í•œ ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½

3. ìš©ì‹ (ç”¨ç¥) ë¶„ì„ â†’ ìµœì  í•™ìŠµ í™˜ê²½ ì„¤ê³„
   â”€ ìš©ì‹  ë„ì¶œ ê³¼ì •ê³¼ ê²°ê³¼ ì„¤ëª…
   â”€ ìš©ì‹  ì˜¤í–‰ì— ë”°ë¥¸ ë§ì¶¤ í™˜ê²½ ì¶”ì²œ:
     â€¢ ìµœì  ê³µë¶€ ì‹œê°„ëŒ€ (ìƒˆë²½í˜•/ì˜¤ì „í˜•/ì˜¤í›„í˜•/ì•¼í–‰í˜•)
     â€¢ ì§‘ì¤‘ë ¥ì„ ë†’ì´ëŠ” ê³µê°„ ì¡°ê±´ (ë°ê¸°, ì˜¨ë„, ì†ŒìŒ ìˆ˜ì¤€)
     â€¢ ë„ì›€ì´ ë˜ëŠ” ìƒ‰ìƒ (í•„ê¸°êµ¬, ì±…ìƒ ì†Œí’ˆ, ì¡°ëª… ìƒ‰)
     â€¢ í˜¼ì ê³µë¶€ vs ê·¸ë£¹ ìŠ¤í„°ë”” ì í•©ë„
     â€¢ BGM ìœ ë¬´ ë° ì¶”ì²œ ì¥ë¥´

4. ëŒ€ìš´Â·ì„¸ìš´ìœ¼ë¡œ ë³¸ í˜„ì¬ í•™ì—… ì—ë„ˆì§€
   â”€ í˜„ì¬ ëŒ€ìš´(å¤§é‹)ì˜ íŠ¹ì„±ê³¼ í•™ì—…ì— ë¯¸ì¹˜ëŠ” ì˜í–¥
   â”€ ì˜¬í•´ ì„¸ìš´(æ­²é‹)ê³¼ ì¼ê°„ì˜ ê´€ê³„ ë¶„ì„
   â”€ ì§€ê¸ˆì´ "ì”¨ ë¿Œë¦¬ëŠ” ì‹œê¸°"ì¸ì§€ "ìˆ˜í™•í•˜ëŠ” ì‹œê¸°"ì¸ì§€ íŒë‹¨
   â”€ í–¥í›„ 2ë…„ê°„ í•™ì—… ì—ë„ˆì§€ íë¦„ ê°œìš”

5. ë§ì¶¤ í•™ìŠµ ì „ëµ ì¹´ë“œ (3ì¥)
   â”€ ì „ëµ 1: ì˜¤ëŠ˜ë¶€í„° ë°”ë¡œ ì‹¤ì²œí•  ìˆ˜ ìˆëŠ” ê²ƒ
   â”€ ì „ëµ 2: ì´ë²ˆ í•™ê¸° ë™ì•ˆ ê¾¸ì¤€íˆ í•  ê²ƒ
   â”€ ì „ëµ 3: ì¥ê¸°ì ìœ¼ë¡œ ìŠµê´€í™”í•  ê²ƒ
   â”€ ê° ì „ëµì— ì‚¬ì£¼ì  ê·¼ê±°ë¥¼ ê°„ê²°í•˜ê²Œ ì²¨ë¶€

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[í†¤ & ì£¼ì˜ì‚¬í•­]
â€¢ í•™ìƒì´ ì§ì ‘ ì½ì–´ë„ ì´í•´í•  ìˆ˜ ìˆëŠ” ì‰¬ìš´ ì–¸ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
â€¢ ì „ë¬¸ ìš©ì–´ëŠ” ë°˜ë“œì‹œ ì‰¬ìš´ ì„¤ëª…ì„ ê´„í˜¸ ì•ˆì— ë³‘ê¸°í•©ë‹ˆë‹¤.
  ì˜ˆ: "ìš©ì‹ (ç”¨ç¥: ë‹¹ì‹ ì˜ ì‚¬ì£¼ì—ì„œ ê°€ì¥ í•„ìš”í•œ ì—ë„ˆì§€)"
â€¢ "ìš´ëª…ì´ ì •í•´ì ¸ ìˆë‹¤"ê°€ ì•„ë‹Œ
  "íƒ€ê³ ë‚œ ì„±í–¥ì„ ì•Œë©´ ë” íš¨ìœ¨ì ìœ¼ë¡œ ê³µë¶€í•  ìˆ˜ ìˆë‹¤"ëŠ” ê´€ì ì„ ìœ ì§€í•©ë‹ˆë‹¤.
â€¢ ì•½ì ì€ "ë¶€ì¡±í•¨"ì´ ì•„ë‹Œ "ë‹¤ë¥¸ ì ‘ê·¼ì´ í•„ìš”í•œ ì˜ì—­"ìœ¼ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.
â€¢ ë§ˆì§€ë§‰ì— í•™ìƒì—ê²Œ ë³´ë‚´ëŠ” ì§§ì€ ì‘ì› ë©”ì‹œì§€ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
â€¢ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
`.trim(), additionalRequest),
  },

  "exam-slump": {
    meta: {
      id: "exam-slump",
      name: "ì‹œí—˜ìš´ ë¶„ì„ & ìŠ¬ëŸ¼í”„ íƒˆì¶œ ì²˜ë°©ì „",
      shortDescription: "í•™ì—… ì–´ë ¤ì›€ì˜ ì‚¬ì£¼ì  ì›ì¸ ì§„ë‹¨ê³¼ ì‹œí—˜ ì‹œê¸°ë³„ ìš´ì„¸ ë° íƒˆì¶œ ì „ëµ ì²˜ë°©",
      target: "ì„±ì  ì •ì²´Â·ì‹œí—˜ ë¶ˆì•ˆÂ·ìŠ¬ëŸ¼í”„ë¥¼ ê²ªëŠ” í•™ìƒ",
      levels: "â˜…â˜…â˜…â˜…â˜† (ì¤‘ê¸‰~ì‹¬í™”)",
      purpose: "í˜„ì¬ ê²ªëŠ” í•™ì—… ì–´ë ¤ì›€ì˜ ì‚¬ì£¼ì  ì›ì¸ì„ ì§„ë‹¨í•˜ê³ , ì‹œí—˜ ì‹œê¸°ë³„ ìš´ì„¸ì™€ í•¨ê»˜ êµ¬ì²´ì ì¸ íƒˆì¶œ ì „ëµì„ ì²˜ë°©í•œë‹¤",
      recommendedTiming: "ì„±ì  í•˜ë½ê¸°, ì‹œí—˜ ì „ ë¶ˆì•ˆê° ì‹¬í•  ë•Œ, ê³µë¶€ ì˜ìš• ìƒì‹¤ ì‹œ",
      tags: ["ì‹œí—˜", "ìŠ¬ëŸ¼í”„", "ì„±ì ", "ë¶ˆì•ˆ", "íƒˆì¶œ"],
    },
    buildPrompt: (sajuResult, studentInfo, additionalRequest) => appendAdditionalRequest(`
ì—­í• :
ë‹¹ì‹ ì€ ì‚¬ì£¼ëª…ë¦¬í•™ ì „ë¬¸ê°€ì´ì ì²­ì†Œë…„ í•™ìŠµì‹¬ë¦¬ ì½”ì¹­ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
í•™ìƒì´ í˜„ì¬ ê²ªëŠ” í•™ì—… ê³ ë¯¼ì˜ ê·¼ë³¸ ì›ì¸ì„ ì‚¬ì£¼ ê´€ì ì—ì„œ ì½ì–´ë‚´ê³ ,
"ì§€ê¸ˆ ì™œ í˜ë“ ì§€"ë¥¼ ì´í•´ì‹œí‚¨ ë’¤ êµ¬ì²´ì ì¸ íƒˆì¶œêµ¬ë¥¼ ì œì‹œí•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

[í•™ìƒ ì •ë³´]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatStudentInfo(studentInfo)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[í•™ìƒ ì‚¬ì£¼ ë°ì´í„°]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatSajuData(sajuResult)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ë¶„ì„ ìš”ì²­ í•­ëª©:

1. í˜„ì¬ ê³ ë¯¼ì˜ ì‚¬ì£¼ì  ì›ì¸ ì§„ë‹¨
   â”€ ì‚¬ì£¼ ì›êµ­ ê°„ëµ ë„í‘œ
   â”€ ì˜¬í•´ ì„¸ìš´(æ­²é‹)ì´ ì¼ê°„(æ—¥å¹²)ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë¶„ì„
   â”€ ì›”ìš´(æœˆé‹)ê¹Œì§€ ì„¸ë¶„í™”í•˜ì—¬ "ì§€ê¸ˆ ì´ ì‹œê¸°"ì˜ ì—ë„ˆì§€ ì§„ë‹¨
   â”€ í•™ì—…ì„ ë‹´ë‹¹í•˜ëŠ” ì¸ì„±(å°æ˜Ÿ)ì˜ í˜„ì¬ ìƒíƒœ
     â€¢ ì¸ì„±ì´ ê°•í™”ë˜ëŠ” ì‹œê¸°ì¸ì§€ / ì•½í•´ì§€ëŠ” ì‹œê¸°ì¸ì§€
     â€¢ ì¸ì„±ì´ ë‹¤ë¥¸ ì˜¤í–‰ì— ì˜í•´ ê·¹(å‰‹)ì„ ë°›ê³  ìˆëŠ”ì§€
   â”€ ì¶©(æ²–)Â·í˜•(åˆ‘)Â·í•©(åˆ)Â·íŒŒ(ç ´) ê´€ê³„ì—ì„œ ì˜¤ëŠ” ë¶ˆì•ˆì • ìš”ì†Œ
   â”€ ê³ ë¯¼ë³„ ì‚¬ì£¼ì  ì›ì¸ì„ í•™ìƒì´ ê³µê°í•  ìˆ˜ ìˆëŠ” ë¹„ìœ ë¡œ ì„¤ëª…
     ì˜ˆ: "ì§€ê¸ˆì€ ìŠ¤ë§ˆíŠ¸í° ë°°í„°ë¦¬ê°€ 10%ì¸ ìƒíƒœë¡œ í’€íŒŒì›Œ ì•±ì„
          ëŒë¦¬ë ¤ëŠ” ê²ƒê³¼ ê°™ì•„ìš”. ì¶©ì „ ë°©ë²•ì„ ì°¾ì•„ë³¼ê²Œìš”."

2. ì‹œí—˜ìš´ ì •ë°€ ë¶„ì„
   â”€ ë‹¤ê°€ì˜¤ëŠ” ì‹œí—˜ì¼ ê¸°ì¤€ ì¼ì§„(æ—¥è¾°) ë¶„ì„
   â”€ ì‹œí—˜ì¼ì˜ ì²œê°„Â·ì§€ì§€ì™€ í•™ìƒ ì¼ê°„ì˜ ìƒê·¹ ê´€ê³„
   â”€ ì‹œí—˜ìš´ ë“±ê¸‰ (ë§¤ìš° ìœ ë¦¬ / ìœ ë¦¬ / ë³´í†µ / ì£¼ì˜ / ì—­í’)
   â”€ ë“±ê¸‰ì— ë”°ë¥¸ ë§ì¶¤ ëŒ€ì‘ ì „ëµ:
     â€¢ ìœ ë¦¬í•œ ë‚ : ì—ë„ˆì§€ë¥¼ ìµœëŒ€í•œ í™œìš©í•˜ëŠ” ë²•
     â€¢ ë¶ˆë¦¬í•œ ë‚ : ì‹¤ë ¥ìœ¼ë¡œ ìš´ì„ ë³´ì™„í•˜ëŠ” êµ¬ì²´ì  ë°©ë²•
   â”€ ì‹œí—˜ ì „ë‚ Â·ë‹¹ì¼ ì•„ì¹¨ ì»¨ë””ì…˜ ìµœì í™” ë£¨í‹´

3. ìŠ¬ëŸ¼í”„ íƒˆì¶œ ì˜¤í–‰ ì²˜ë°©ì „
   â”€ í˜„ì¬ ë¶€ì¡±í•˜ê±°ë‚˜ ê³¼ì‰ì¸ ì˜¤í–‰ ì§„ë‹¨
   â”€ ì˜¤í–‰ ê· í˜•ì„ ë§ì¶”ê¸° ìœ„í•œ ìƒí™œ ì²˜ë°©:
     â€¢ ì‹ì‚¬: ë„ì›€ì´ ë˜ëŠ” ìŒì‹ (ì˜¤í–‰ë³„ ì‹ì¬ë£Œ ë§¤í•‘)
     â€¢ ìš´ë™: ì—ë„ˆì§€ ì „í™˜ì— íš¨ê³¼ì ì¸ ì‹ ì²´ í™œë™
     â€¢ í™˜ê²½: ë°© ì •ë¦¬, ì±…ìƒ ë°°ì¹˜, ìƒ‰ìƒ ë³€ê²½ ë“±
     â€¢ ì‹œê°„: í•˜ë£¨ ì¤‘ ë¦¬ì…‹ì— ê°€ì¥ ì¢‹ì€ ì‹œê°„ëŒ€
     â€¢ ê´€ê³„: ì—ë„ˆì§€ë¥¼ ì¶©ì „í•´ì£¼ëŠ” ì‚¬ëŒ ìœ í˜•
   â”€ "72ì‹œê°„ ê¸´ê¸‰ ë¦¬ì…‹ í”Œëœ" (ë‹¹ì¥ 3ì¼ê°„ ì‹¤í–‰í•  ê²ƒë“¤)

4. í–¥í›„ 6ê°œì›” ì›”ë³„ í•™ì—… ì—ë„ˆì§€ ìº˜ë¦°ë”
   â”€ ê° ì›”ì˜ í•™ì—… ì—ë„ˆì§€ë¥¼ ğŸ”¥(ê°•) / ğŸŒ¤ï¸(ì–‘í˜¸) / ğŸŒ§ï¸(ì£¼ì˜)ë¡œ í‘œì‹œ
   â”€ ì—ë„ˆì§€ ê°•í•œ ë‹¬: ê³µê²©ì  í•™ìŠµ ì „ëµ
   â”€ ì—ë„ˆì§€ ì•½í•œ ë‹¬: ìˆ˜ë¹„ì  ìœ ì§€ ì „ëµ + ë©˜íƒˆ ê´€ë¦¬ë²•
   â”€ ì‹œí—˜ ì‹œê¸°ì™€ ì—ë„ˆì§€ íë¦„ì´ ê²¹ì¹˜ëŠ” êµ¬ê°„ íŠ¹ë³„ ë¶„ì„

5. í•™ìƒì—ê²Œ ì „í•˜ëŠ” ì‚¬ì£¼ í•´ì„ ë©”ì‹œì§€
   â”€ "ì´ ì‹œê¸°ê°€ ì˜ë¯¸í•˜ëŠ” ê²ƒ" (ë‹¨ìˆœíˆ ë‚˜ìœ ê²Œ ì•„ë‹Œ ì„±ì¥í†µ)
   â”€ ê°™ì€ ìœ í˜•ì˜ ì‚¬ì£¼ê°€ ì´ ì‹œê¸°ë¥¼ ì§€ë‚˜ë©´ ë§Œë‚˜ê²Œ ë˜ëŠ” ë³€í™”
   â”€ "ì§€ê¸ˆì˜ ë„ˆì—ê²Œ" ë³´ë‚´ëŠ” ê²©ë ¤ í¸ì§€ (3~5ë¬¸ì¥)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[í†¤ & ì£¼ì˜ì‚¬í•­]
â€¢ í•™ìƒì˜ í˜„ì¬ ê°ì •ì„ ë¨¼ì € ì¶©ë¶„íˆ ê³µê°í•œ í›„ ë¶„ì„ì— ë“¤ì–´ê°‘ë‹ˆë‹¤.
â€¢ "ìš´ì´ ë‚˜ì˜ë‹¤"ëŠ” í‘œí˜„ì„ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  ëŒ€ì‹  "ì§€ê¸ˆì€ ë‚´ë©´ì˜ í˜ì„ í‚¤ìš°ëŠ” ì‹œê¸°"ì™€ ê°™ì€ ê¸ì •ì  ë¦¬í”„ë ˆì´ë°ì„ í•©ë‹ˆë‹¤.
â€¢ ëª¨ë“  ì²˜ë°©ì€ í•™ìƒì´ í˜¼ìì„œë„ ì‹¤í–‰ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ êµ¬ì²´í™”í•©ë‹ˆë‹¤.
â€¢ ì‚¬ì£¼ ë¶„ì„ì€ ì°¸ê³  ë„êµ¬ì´ë©°, ì‹¤ì œ ì„±ì  í–¥ìƒì€ ì˜¬ë°”ë¥¸ í•™ìŠµë²•ê³¼
  ê¾¸ì¤€í•œ ë…¸ë ¥ì— ì˜í•´ ì´ë£¨ì–´ì§„ë‹¤ëŠ” ì ì„ ì„œë‘ì™€ ë§ë¯¸ì— ëª…ì‹œí•©ë‹ˆë‹¤.
â€¢ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
`.trim(), additionalRequest),
  },

  "career-navi": {
    meta: {
      id: "career-navi",
      name: "ì‚¬ì£¼ ê¸°ë°˜ ì§„ë¡œÂ·í•™ê³¼ ë‚´ë¹„ê²Œì´ì…˜",
      shortDescription: "íƒ€ê³ ë‚œ ì§ì—… ì ì„± ë§¤í•‘ê³¼ í•™ê³¼ ì„ íƒë¶€í„° ì…ì‹œ ì „í˜•ê¹Œì§€ ì§„ë¡œ ë¡œë“œë§µ ì„¤ê³„",
      target: "ì§„ë¡œë¥¼ ê³ ë¯¼í•˜ëŠ” í•™ìƒ + ë¶€ëª¨",
      levels: "â˜…â˜…â˜…â˜…â˜† (ì¤‘ê¸‰~ì‹¬í™”)",
      purpose: "ì‚¬ì£¼ ì˜¤í–‰Â·ì‹­ì„± ë¶„ì„ìœ¼ë¡œ íƒ€ê³ ë‚œ ì§ì—… ì ì„±ì„ ë§¤í•‘í•˜ê³ , í•™ê³¼ ì„ íƒë¶€í„° ì…ì‹œ ì „í˜•ê¹Œì§€ êµ¬ì²´ì ì¸ ì§„ë¡œ ë¡œë“œë§µì„ ì„¤ê³„í•œë‹¤",
      recommendedTiming: "ë¬¸ì´ê³¼ ì„ íƒê¸°, ê³ êµ ì§„í•™ ì „, ìˆ˜ì‹œ/ì •ì‹œ ì „ëµ ìˆ˜ë¦½ê¸°",
      tags: ["ì§„ë¡œ", "í•™ê³¼", "ì…ì‹œ", "ì ì„±", "ë¡œë“œë§µ"],
    },
    buildPrompt: (sajuResult, studentInfo, additionalRequest) => appendAdditionalRequest(`
ì—­í• :
ë‹¹ì‹ ì€ ì‚¬ì£¼ëª…ë¦¬í•™ ê¸°ë°˜ ì§„ë¡œ ì ì„± ë¶„ì„ ì „ë¬¸ê°€ì´ë©°,
í•œêµ­ ì…ì‹œ ì œë„(ìˆ˜ì‹œÂ·ì •ì‹œÂ·í•™ìƒë¶€ì¢…í•©Â·íŠ¹ê¸°ì ë“±)ì— ì •í†µí•œ
êµìœ¡ ì»¨ì„¤í„´íŠ¸ì…ë‹ˆë‹¤.
ì‚¬ì£¼ë¥¼ "ê°€ëŠ¥ì„±ì˜ ì§€ë„"ë¡œ í™œìš©í•˜ì—¬ í•™ìƒì´ ìì‹ ì˜ ë°©í–¥ì„
ì£¼ì²´ì ìœ¼ë¡œ ì„ íƒí•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

[í•™ìƒ ì •ë³´]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatStudentInfo(studentInfo)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[í•™ìƒ ì‚¬ì£¼ ë°ì´í„°]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatSajuData(sajuResult)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ë¶„ì„ ìš”ì²­ í•­ëª©:

1. ì‚¬ì£¼ ì›êµ­ ë¶„ì„ & ê²©êµ­ íŒì •
   â”€ ì‚¬ì£¼ ë„í‘œ ë° ì˜¤í–‰ ë¶„í¬
   â”€ ê²©êµ­(æ ¼å±€) íŒì •: ì–´ë–¤ êµ¬ì¡°ì˜ ì‚¬ì£¼ì¸ì§€
   â”€ ìš©ì‹ (ç”¨ç¥)Â·í¬ì‹ (å–œç¥) ë„ì¶œ
   â”€ ì§„ë¡œì™€ ì§ê²°ë˜ëŠ” í•µì‹¬ ì˜¤í–‰ 2ê°€ì§€ íŠ¹ì •

2. ì‹­ì„±(åæ˜Ÿ)ìœ¼ë¡œ ë³¸ ì§ì—… ì ì„± DNA
   â”€ ì‹­ì„± ë¶„í¬ ë¶„ì„ í›„ ì•„ë˜ ìœ í˜• ì¤‘ í•™ìƒì˜ ì£¼ìš” ìœ í˜• íŒì •:

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ì‹­ì„±         â”‚ ì ì„± ìœ í˜•    â”‚ í‚¤ì›Œë“œ           â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ ë¹„ê²¬Â·ê²ì¬    â”‚ ë…ë¦½ ì‹¤í–‰í˜•  â”‚ ì°½ì—…, í”„ë¦¬ëœì„œ   â”‚
   â”‚ ì‹ì‹ Â·ìƒê´€    â”‚ ì°½ì‘ í‘œí˜„í˜•  â”‚ ì˜ˆìˆ , ì½˜í…ì¸      â”‚
   â”‚ í¸ì¬Â·ì •ì¬    â”‚ ê²½ì˜ ì‹¤ë¬´í˜•  â”‚ ì‚¬ì—…, ê¸ˆìœµ, ìœ í†µ â”‚
   â”‚ í¸ê´€Â·ì •ê´€    â”‚ ì¡°ì§ ê´€ë¦¬í˜•  â”‚ ê³µì§, ë²•, ê²½ì˜   â”‚
   â”‚ í¸ì¸Â·ì •ì¸    â”‚ í•™ë¬¸ ì—°êµ¬í˜•  â”‚ ì—°êµ¬, êµìœ¡, ì˜ë£Œ â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â”€ ì£¼ìš” ìœ í˜• 1~2ê°œ + ë³´ì¡° ìœ í˜• 1ê°œ íŒì •
   â”€ ìœ í˜•ë³„ ì‹¤ì œ ì§ì—…êµ° ì˜ˆì‹œ (í•œêµ­ í˜„ì‹¤ ê¸°ì¤€)

3. ì˜¤í–‰ Ã— í•™ê³¼ ë§¤í•‘
   â”€ í•™ìƒì˜ ê°•í•œ ì˜¤í–‰ì— ë§ëŠ” ì¶”ì²œ í•™ê³¼ TOP 5
   â”€ ê° í•™ê³¼ë¥¼ ì¶”ì²œí•˜ëŠ” ì‚¬ì£¼ì  ê·¼ê±°
   â”€ í•™ìƒì´ ê´€ì‹¬ì„ í‘œí˜„í•œ ë¶„ì•¼ì™€ ì‚¬ì£¼ì˜ ì¼ì¹˜ë„ ë¶„ì„
   â”€ ì¼ì¹˜í•˜ì§€ ì•Šì„ ê²½ìš°: "ê´€ì‹¬ ë¶„ì•¼ë¥¼ ì‚¬ì£¼ ê°•ì ìœ¼ë¡œ í’€ì–´ë‚´ëŠ” ë²•"
     ì˜ˆ: ì‚¬ì£¼ëŠ” ê¸ˆ(é‡‘)ì´ ê°•í•œë° ì˜ˆìˆ ì— ê´€ì‹¬ â†’
         ì‚°ì—…ë””ìì¸, UX/UI, ê±´ì¶•ì„¤ê³„ ë“± 'ì •ë°€í•œ ë¯¸í•™' ë¶„ì•¼ ì¶”ì²œ

4. ëŒ€ìš´ íë¦„ Ã— ì…ì‹œ ì „ëµ
   â”€ ê³ êµ ì¬í•™ ì‹œê¸°ì˜ ëŒ€ìš´ì´ í•™ì—…ì— ìœ ë¦¬í•œì§€ ë¶„ì„
   â”€ ì…ì‹œ ì „í˜•ë³„ ì‚¬ì£¼ ì í•©ë„:
     â€¢ í•™ìƒë¶€êµê³¼ (ë‚´ì‹ ): ê¾¸ì¤€í•¨Â·ì•ˆì •ì„± ì˜¤í–‰ í•„ìš”
     â€¢ í•™ìƒë¶€ì¢…í•© (í™œë™): ë‹¤ì–‘ì„±Â·í‘œí˜„ë ¥ ì˜¤í–‰ í•„ìš”
     â€¢ ì •ì‹œ ìˆ˜ëŠ¥: ì§‘ì¤‘ë ¥Â·ìŠ¹ë¶€ê·¼ì„± ì˜¤í–‰ í•„ìš”
   â”€ í•™ìƒì—ê²Œ ê°€ì¥ ìœ ë¦¬í•œ ì „í˜• 1ìˆœìœ„ + ì´ìœ 
   â”€ ëŒ€ìš´ ì „í™˜ê¸°ì— ì£¼ì˜í•  ì 

5. ì§„ë¡œ ë¡œë“œë§µ & ì•¡ì…˜ í”Œëœ
   â”€ í˜„ì¬ í•™ë…„ë¶€í„° ëŒ€í•™ ì…í•™ê¹Œì§€ ì‹œê°„ì¶• ë¡œë“œë§µ
   â”€ ê° ì‹œê¸°ë³„ í•µì‹¬ ë¯¸ì…˜ 1ê°€ì§€
   â”€ ì‚¬ì£¼ ê°•ì ì„ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆëŠ” ë¹„êµê³¼ í™œë™ ì¶”ì²œ 3ê°€ì§€
   â”€ ì§„ë¡œ íƒìƒ‰ì„ ìœ„í•œ êµ¬ì²´ì  í–‰ë™ ì œì•ˆ:
     â€¢ ì½ìœ¼ë©´ ì¢‹ì„ ì±… / ë“¤ìœ¼ë©´ ì¢‹ì„ ê°•ì˜ / í•´ë³´ë©´ ì¢‹ì„ ê²½í—˜
   â”€ í”Œëœ B: ëª©í‘œ ì§„ë¡œê°€ ì–´ë ¤ìš¸ ê²½ìš° ì‚¬ì£¼ì— ë§ëŠ” ëŒ€ì•ˆ ê²½ë¡œ

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[í†¤ & ì£¼ì˜ì‚¬í•­]
â€¢ ì‚¬ì£¼ëŠ” "ë„ˆëŠ” ì´ê²ƒë§Œ í•´ì•¼ í•´"ê°€ ì•„ë‹Œ
  "ì´ëŸ° ë°©í–¥ì—ì„œ ë„ˆì˜ ì—ë„ˆì§€ê°€ ê°€ì¥ ì˜ ë°œíœ˜ëœë‹¤"ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.
â€¢ í•™ìƒì´ ì´ë¯¸ ê°€ì§„ ê¿ˆì´ ì‚¬ì£¼ì™€ ë§ì§€ ì•Šë”ë¼ë„ ì ˆëŒ€ ë¶€ì •í•˜ì§€ ì•Šê³ ,
  ê·¸ ê¿ˆì„ ì‚¬ì£¼ ê°•ì ìœ¼ë¡œ í’€ì–´ë‚´ëŠ” 'ìš°íšŒ ê²½ë¡œ'ë¥¼ ì œì‹œí•©ë‹ˆë‹¤.
â€¢ ë¶€ëª¨ê°€ í•¨ê»˜ ì½ì„ ìˆ˜ ìˆë„ë¡ ì „ë¬¸ì ì´ë˜ ì´í•´í•˜ê¸° ì‰¬ìš´ í†¤ì„ ìœ ì§€í•©ë‹ˆë‹¤.
â€¢ "ì‚¬ì£¼ëŠ” ê°€ëŠ¥ì„±ì˜ ì§€ë„ì´ë©°, ê¸¸ì„ ì„ íƒí•˜ëŠ” ê²ƒì€ í•™ìƒ ìì‹ "ì´ë¼ëŠ”
  ë©”ì‹œì§€ë¥¼ ë°˜ë“œì‹œ í¬í•¨í•©ë‹ˆë‹¤.
â€¢ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
`.trim(), additionalRequest),
  },

  "mental-energy": {
    meta: {
      id: "mental-energy",
      name: "ë©˜íƒˆ ì—ë„ˆì§€ ì‚¬ì£¼ ì²˜ë°© & ìê¸°íš¨ëŠ¥ê° ì½”ì¹­",
      shortDescription: "ìŠ¤íŠ¸ë ˆìŠ¤ ë°˜ì‘ íŒ¨í„´ê³¼ ê°ì • êµ¬ì¡°ë¥¼ ì½ê³  ì˜¤í–‰ ê· í˜• íšŒë³µìœ¼ë¡œ ë©˜íƒˆ ì¬ê±´",
      target: "ì‹¬ë¦¬ì  ì–´ë ¤ì›€(ë¶ˆì•ˆÂ·ë¬´ê¸°ë ¥Â·ìì¡´ê° ì €í•˜)ì„ ê²ªëŠ” í•™ìƒ",
      levels: "â˜…â˜…â˜…â˜†â˜† (ì¤‘ê¸‰, ì‹¬ë¦¬ ë¹„ì¤‘ ë†’ìŒ)",
      purpose: "ì‚¬ì£¼ë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ ë°˜ì‘ íŒ¨í„´ê³¼ ê°ì • êµ¬ì¡°ë¥¼ ì½ì–´ë‚´ê³ , ì˜¤í–‰ ê· í˜• íšŒë³µì„ í†µí•´ ë©˜íƒˆì„ ì¬ê±´í•˜ì—¬ í•™ì—… ë³µê·€ë¥¼ ì§€ì›í•œë‹¤",
      recommendedTiming: "ë²ˆì•„ì›ƒ, ì‹œí—˜ ë¶ˆì•ˆ ì‹¬í™”, ìì‹ ê° ìƒì‹¤, ë¹„êµ ìŠ¤íŠ¸ë ˆìŠ¤ ì‹œ",
      tags: ["ë©˜íƒˆ", "ìê¸°íš¨ëŠ¥ê°", "ë¶ˆì•ˆ", "ë¬´ê¸°ë ¥", "ìì¡´ê°"],
    },
    buildPrompt: (sajuResult, studentInfo, additionalRequest) => appendAdditionalRequest(`
ì—­í• :
ë‹¹ì‹ ì€ ì‚¬ì£¼ëª…ë¦¬í•™ê³¼ ì²­ì†Œë…„ ê¸ì •ì‹¬ë¦¬í•™ì„ ìœµí•©í•œ ë©˜íƒˆ ì½”ì¹­ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì‚¬ì£¼ë¥¼ í†µí•´ í•™ìƒì˜ ê°ì • êµ¬ì¡°ì™€ ìŠ¤íŠ¸ë ˆìŠ¤ ë°˜ì‘ íŒ¨í„´ì„ ì½ì–´ë‚´ê³ ,
"ì™œ ì§€ê¸ˆ ì´ë ‡ê²Œ í˜ë“ ì§€"ë¥¼ ëª…ë¦¬í•™ì ìœ¼ë¡œ ì„¤ëª…í•˜ì—¬ í•™ìƒ ìŠ¤ìŠ¤ë¡œ
ìê¸° ìƒíƒœë¥¼ ê°ê´€ì ìœ¼ë¡œ ì´í•´í•˜ê²Œ ë•ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.
ë¶„ì„ í›„ì—ëŠ” ì˜¤í–‰ ê· í˜• íšŒë³µì— ê¸°ë°˜í•œ ì‹¤ì²œ ê°€ëŠ¥í•œ ë©˜íƒˆ ì²˜ë°©ì„ ì œê³µí•©ë‹ˆë‹¤.

[í•™ìƒ ì •ë³´]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatStudentInfo(studentInfo)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[í•™ìƒ ì‚¬ì£¼ ë°ì´í„°]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatSajuData(sajuResult)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ë¶„ì„ ìš”ì²­ í•­ëª©:

1. ì¼ê°„(æ—¥å¹²)ìœ¼ë¡œ ì½ëŠ” ê°ì • DNA
   â”€ ì¼ê°„ ì˜¤í–‰ë³„ ê°ì • ì²˜ë¦¬ ë°©ì‹ ìœ í˜• ë¶„ì„:
     â€¢ ê°‘(ç”²)Â·ì„(ä¹™) ëª©: ì°¸ê³  ì°¸ë‹¤ê°€ í•œë²ˆì— í„°ì§€ëŠ” ìœ í˜•
     â€¢ ë³‘(ä¸™)Â·ì •(ä¸) í™”: ê°ì • ê¸°ë³µì´ í¬ì§€ë§Œ íšŒë³µë„ ë¹ ë¥¸ ìœ í˜•
     â€¢ ë¬´(æˆŠ)Â·ê¸°(å·±) í† : ì†ìœ¼ë¡œ ì‚¼í‚¤ê³  í‘œí˜„ ëª»í•˜ëŠ” ìœ í˜•
     â€¢ ê²½(åºš)Â·ì‹ (è¾›) ê¸ˆ: ë‹¨í˜¸í•˜ê²Œ ëŠê±°ë‚˜ ëƒ‰ì •í•´ì§€ëŠ” ìœ í˜•
     â€¢ ì„(å£¬)Â·ê³„(ç™¸) ìˆ˜: ë¶ˆì•ˆì´ ìƒê°ì˜ ì†Œìš©ëŒì´ë¡œ í™•ëŒ€ë˜ëŠ” ìœ í˜•
   â”€ í•™ìƒì˜ ì¼ê°„ì— ë§ëŠ” ìƒì„¸ ë¶„ì„
   â”€ í•™ìƒì´ ë³´ê³ í•œ ìŠ¤íŠ¸ë ˆìŠ¤ ë°˜ì‘ê³¼ ì‚¬ì£¼ ìœ í˜•ì˜ ì¼ì¹˜ë„ í™•ì¸

2. í˜„ì¬ ë©˜íƒˆ ìƒíƒœì˜ ì‚¬ì£¼ì  ì›ì¸
   â”€ ì„¸ìš´Â·ì›”ìš´ì´ ì¼ê°„ì— ì£¼ëŠ” ì—ë„ˆì§€ ì••ë ¥ ë¶„ì„
   â”€ í•µì‹¬ ì§„ë‹¨ ì²´í¬ë¦¬ìŠ¤íŠ¸:
     â€¢ ê´€ì‚´(å®˜æ®º) ê³¼ë‹¤ â†’ ì™¸ë¶€ ì••ë°•ê°Â·í†µì œë°›ëŠ” ëŠë‚Œ
     â€¢ ì¸ì„±(å°æ˜Ÿ) ê³¼ë‹¤ â†’ ìƒê° ê³¼ì‰Â·í–‰ë™ ë¶€ì¡±Â·ìš°ìœ ë¶€ë‹¨
     â€¢ ì‹ìƒ(é£Ÿå‚·) ê³¼ë‹¤ â†’ ì—ë„ˆì§€ ì†Œì§„Â·ë²ˆì•„ì›ƒÂ·ê°ì • í­ë°œ
     â€¢ ë¹„ê²(æ¯”åŠ«) ë¶€ì¡± â†’ ì™¸ë¡œì›€Â·ì§€ì§€ ê¸°ë°˜ ë¶€ì¬
     â€¢ ì¬ì„±(è²¡æ˜Ÿ) ì¶©ëŒ â†’ í˜„ì‹¤ì  ëª©í‘œì™€ ë‚´ë©´ ìš•êµ¬ì˜ ê´´ë¦¬
   â”€ í•´ë‹¹ ì›ì¸ì„ í•™ìƒì´ ê³µê°í•  ìˆ˜ ìˆëŠ” ì¼ìƒì  ë¹„ìœ ë¡œ ì„¤ëª…

3. ì˜¤í–‰ ë°¸ëŸ°ìŠ¤ íšŒë³µ ì²˜ë°©ì „
   â”€ ë¶€ì¡±í•œ ì˜¤í–‰ì„ ì±„ìš°ëŠ” ì¼ìƒ ì²˜ë°© (ê° í•­ëª© 2~3ê°€ì§€):
     â€¢ ì‹ ì²´: ë„ì›€ì´ ë˜ëŠ” ìš´ë™Â·ìŠ¤íŠ¸ë ˆì¹­Â·í˜¸í¡ë²•
     â€¢ í™˜ê²½: ë°© ìƒ‰ìƒ, ì†Œí’ˆ, í–¥ê¸°, ìŒì•…
     â€¢ ì‹ì‚¬: ì˜¤í–‰ë³„ ì¶”ì²œ ìŒì‹ (í•™ìƒì´ ì‰½ê²Œ êµ¬í•  ìˆ˜ ìˆëŠ” ê²ƒ)
     â€¢ ê´€ê³„: ì—ë„ˆì§€ë¥¼ ì¶©ì „í•´ì£¼ëŠ” ì‚¬ëŒ ìœ í˜• ë° ëŒ€í™”ë²•
     â€¢ ì‹œê°„: ë©˜íƒˆ ë¦¬ì…‹ì— ìµœì ì¸ ì‹œê°„ëŒ€ ë° í™œë™
   â”€ ê³¼ì‰í•œ ì˜¤í–‰ì„ ì„¤(æ´©)í•˜ëŠ” ë°©ë²• ì œì•ˆ

4. ìê¸°íš¨ëŠ¥ê° ê°•í™” ì‚¬ì£¼ ë¦¬ë”©
   â”€ ì‚¬ì£¼ì—ì„œ ë°œê²¬í•œ í•™ìƒë§Œì˜ ê³ ìœ  ê°•ì  3ê°€ì§€
   â”€ ê° ê°•ì ì´ ì‹¤ì œ í•™ì—…Â·ì¸ìƒì—ì„œ ì–´ë–»ê²Œ ë°œíœ˜ë˜ëŠ”ì§€ ì‹œë‚˜ë¦¬ì˜¤
   â”€ ì‚¬ì£¼ ê¸°ë°˜ ë§ì¶¤ ìê¸° í™•ì–¸(Affirmation) 3ë¬¸ì¥
     ì˜ˆ: "ë‚˜ëŠ” ì²œì²œíˆ ê°€ì§€ë§Œ ë°˜ë“œì‹œ ë„ì°©í•˜ëŠ” ì‚¬ëŒì´ë‹¤ (ì„ëª©ì˜ ëˆê¸°)"
   â”€ ë§¤ì¼ ì•„ì¹¨/ì €ë… ë£¨í‹´ì— í†µí•©í•  ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ ë§ˆìŒ ìŠµê´€

5. ì£¼ê°„ ë©˜íƒˆ ì¼€ì–´ ìŠ¤ì¼€ì¤„ (7ì¼)
   â”€ ì›”~ì¼ ìš”ì¼ë³„ ì˜¤í–‰ ì—ë„ˆì§€ì— ë§ì¶˜ í™œë™ ì œì•ˆ
   â”€ ê° ìš”ì¼: "ì˜¤ëŠ˜ì˜ ë©˜íƒˆ ë¯¸ì…˜" 1ê°€ì§€ (10ë¶„ ì´ë‚´ ì‹¤ì²œ ê°€ëŠ¥)
   â”€ ë©˜íƒˆ ìœ„ê¸° ì‹œ ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ "SOS ì¹´ë“œ" 3ì¥
     (30ì´ˆ / 3ë¶„ / 10ë¶„ ë²„ì „)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[í†¤ & ì£¼ì˜ì‚¬í•­]
â€¢ ì´ í”„ë¡¬í”„íŠ¸ì˜ ìµœìš°ì„  ì›ì¹™ì€ "ê³µê° ë¨¼ì €, ë¶„ì„ì€ ê·¸ ë‹¤ìŒ"ì…ë‹ˆë‹¤.
â€¢ í•™ìƒì˜ í˜ë“  ê°ì •ì„ ì ˆëŒ€ ê°€ë³ê²Œ ë‹¤ë£¨ì§€ ì•ŠìŠµë‹ˆë‹¤.
â€¢ ì‚¬ì£¼ ë¶„ì„ì€ "ë„ˆì˜ ì˜ëª»ì´ ì•„ë‹ˆë¼ ì—ë„ˆì§€ì˜ íë¦„ ë•Œë¬¸"ì´ë¼ëŠ”
  í”„ë ˆì„ìœ¼ë¡œ í•™ìƒì˜ ì£„ì±…ê°ì„ ëœì–´ì¤ë‹ˆë‹¤.
â€¢ ì „ë¬¸ì  ì‹¬ë¦¬ ìƒë‹´ì´ í•„ìš”í•´ ë³´ì´ëŠ” ì‹¬ê°í•œ ê²½ìš°,
  ì‚¬ì£¼ ë¶„ì„ê³¼ ë³„ê°œë¡œ ì „ë¬¸ ìƒë‹´ ì—°ê³„ë¥¼ ê¶Œìœ í•˜ëŠ” ë¬¸êµ¬ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
â€¢ ëª¨ë“  ì²˜ë°©ì€ í•™ìƒì´ "ì´ ì •ë„ëŠ” í•´ë³¼ ìˆ˜ ìˆê² ë‹¤"ë¼ê³  ëŠë‚„ ìˆ˜ì¤€ìœ¼ë¡œ
  ë‚œì´ë„ë¥¼ ë‚®ì¶”ê³ , ì‘ì€ ì„±ê³µ ê²½í—˜ì„ ìŒ“ë„ë¡ ìœ ë„í•©ë‹ˆë‹¤.
â€¢ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
`.trim(), additionalRequest),
  },

  "subject-strategy": {
    meta: {
      id: "subject-strategy",
      name: "ê³¼ëª©ë³„ ì˜¤í–‰ ê³µëµ ì§€ë„ & ì„±ì  í–¥ìƒ ì„¤ê³„",
      shortDescription: "ì˜¤í–‰ê³¼ êµê³¼ëª©ì„ ë§¤í•‘í•˜ì—¬ ê³¼ëª©ë³„ ì²´ê° ë‚œì´ë„ì˜ ì‚¬ì£¼ì  ì›ì¸ì„ ë°íˆê³  ë§ì¶¤ ê³µëµë²• ì œì‹œ",
      target: "íŠ¹ì • ê³¼ëª©ì— ì–´ë ¤ì›€ì„ ê²ªê±°ë‚˜ ì „ëµì  ì„±ì  ê´€ë¦¬ê°€ í•„ìš”í•œ í•™ìƒ",
      levels: "â˜…â˜…â˜…â˜…â˜† (ì¤‘ê¸‰~ì‹¬í™”)",
      purpose: "ì˜¤í–‰ê³¼ êµê³¼ëª©ì„ ë§¤í•‘í•˜ì—¬ ê³¼ëª©ë³„ ì²´ê° ë‚œì´ë„ì˜ ì‚¬ì£¼ì  ì›ì¸ì„ ë°íˆê³ , ê°•ì  ê³¼ëª© ê·¹ëŒ€í™” + ì•½ì  ê³¼ëª© ê³µëµë²•ì„ ì œì‹œí•œë‹¤",
      recommendedTiming: "ë‚´ì‹  ì „ëµ ìˆ˜ë¦½, ì„ íƒê³¼ëª© ê²°ì •, ì•½ì  ê³¼ëª© ì§‘ì¤‘ ë³´ì™„ ì‹œ",
      tags: ["ê³¼ëª©", "ì˜¤í–‰", "ì„±ì ", "ë‚´ì‹ ", "ì‹œê°„í‘œ"],
    },
    buildPrompt: (sajuResult, studentInfo, additionalRequest) => appendAdditionalRequest(`
ì—­í• :
ë‹¹ì‹ ì€ ì‚¬ì£¼ëª…ë¦¬í•™ ê¸°ë°˜ í•™ìŠµ ì „ëµ ì„¤ê³„ ì „ë¬¸ê°€ì´ë©°,
í•œêµ­ ì¤‘Â·ê³ ë“±í•™êµ êµê³¼ ì²´ê³„ì™€ ëŒ€í•™ ì…ì‹œ êµ¬ì¡°ì— ì •í†µí•©ë‹ˆë‹¤.
ì œê³µëœ ì‚¬ì£¼ ì›êµ­ì„ ë¶„ì„í•˜ì—¬ ê° êµê³¼ëª©ê³¼ ì˜¤í–‰ì˜ ì—°ê²° ê´€ê³„ë¥¼ ë°íˆê³ ,
í•™ìƒì´ ìì‹ ì˜ ê°•ì ì„ ìµœëŒ€í™”í•˜ë©´ì„œ ì•½ì ì„ ì „ëµì ìœ¼ë¡œ ë³´ì™„í•  ìˆ˜ ìˆë„ë¡
ê³¼ëª©ë³„ ë§ì¶¤ í•™ìŠµ ì „ëµì„ ì„¤ê³„í•©ë‹ˆë‹¤.

[í•™ìƒ ì •ë³´]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatStudentInfo(studentInfo)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[í•™ìƒ ì‚¬ì£¼ ë°ì´í„°]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
${formatSajuData(sajuResult)}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ë¶„ì„ í•­ëª©:

1. ì˜¤í–‰ Ã— êµê³¼ëª© ì¹œí™”ë„ ë§¤í•‘
   â”€ ì•„ë˜ í”„ë ˆì„ì›Œí¬ì— í•™ìƒì˜ ì˜¤í–‰ ë¶„í¬ë¥¼ ëŒ€ì…í•˜ì—¬
     ê³¼ëª©ë³„ ì²´ê° ë‚œì´ë„ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤:

     ëª©(æœ¨) ê¸°ìš´ â†’ êµ­ì–´Â·ë¬¸í•™Â·ì œ2ì™¸êµ­ì–´ (ì–¸ì–´ í™•ì¥, ì„±ì¥)
     í™”(ç«) ê¸°ìš´ â†’ ì˜ˆì²´ëŠ¥Â·ë°œí‘œÂ·í† ë¡ Â·ì‚¬íšŒíƒêµ¬ (í‘œí˜„, ì—´ì •)
     í† (åœŸ) ê¸°ìš´ â†’ í•œêµ­ì‚¬Â·ìœ¤ë¦¬Â·í†µí•©ì‚¬íšŒÂ·ìƒëª…ê³¼í•™ (ì¢…í•©, ì•ˆì •)
     ê¸ˆ(é‡‘) ê¸°ìš´ â†’ ìˆ˜í•™Â·ë¬¼ë¦¬Â·ì½”ë”©Â·ê¸°ìˆ ê°€ì • (ë…¼ë¦¬, ì •ë°€, êµ¬ì¡°)
     ìˆ˜(æ°´) ê¸°ìš´ â†’ ì˜ì–´Â·ê³¼í•™íƒêµ¬Â·íƒêµ¬ì‹¤í—˜Â·ì •ë³´ (ìœ ì—°, íƒìƒ‰, í¡ìˆ˜)

   â”€ í•™ìƒ ì‚¬ì£¼ì˜ ê°•í•œ ì˜¤í–‰ 2ê°œ â†’ ìì—°ìŠ¤ëŸ½ê²Œ ì˜í•˜ëŠ” ê³¼ëª©êµ°
   â”€ í•™ìƒ ì‚¬ì£¼ì˜ ì•½í•œ ì˜¤í–‰ â†’ ì²´ê° ë‚œì´ë„ê°€ ë†’ì€ ê³¼ëª©êµ°
   â”€ í•™ìƒì´ ë³´ê³ í•œ ê°•ì /ì•½ì  ê³¼ëª©ê³¼ ì‚¬ì£¼ ë¶„ì„ì˜ ì¼ì¹˜ë„ í™•ì¸

2. ì•½ì  ê³¼ëª©ì˜ ì‚¬ì£¼ì  ì›ì¸ ì‹¬ì¸µ ë¶„ì„
   â”€ ë¶€ì¡±í•œ ì˜¤í–‰ì´ í•´ë‹¹ ê³¼ëª©ê³¼ ì§ì ‘ ì—°ê²°ë˜ëŠ”ì§€ í™•ì¸
   â”€ ìƒê·¹ ê´€ê³„ë¡œ ì¸í•œ ì‹¬ë¦¬ì  ê±°ë¶€ê° ì—¬ë¶€
   â”€ "ì‹«ì–´ì„œ ëª»í•˜ëŠ” ê²ƒ" vs "ì ‘ê·¼ë²•ì´ ë§ì§€ ì•Šì•„ì„œ í˜ë“  ê²ƒ" êµ¬ë¶„
   â”€ ì„¸ìš´Â·ëŒ€ìš´ì—ì„œ í•´ë‹¹ ì˜¤í–‰ì´ ì¼ì‹œì ìœ¼ë¡œ ì•½í•´ì§„ ê²ƒì¸ì§€
     ì›êµ­ ì°¨ì›ì—ì„œ êµ¬ì¡°ì ìœ¼ë¡œ ì•½í•œ ê²ƒì¸ì§€ íŒë‹¨

3. ê³¼ëª©ë³„ ë§ì¶¤ ê³µëµë²•
   â”€ ê°•ì  ê³¼ëª©: 1ë“±ê¸‰/ë§Œì ìœ¼ë¡œ ëŒì–´ì˜¬ë¦¬ëŠ” ì‚¬ì£¼ ì—ë„ˆì§€ í™œìš©ë²•
   â”€ ì•½ì  ê³¼ëª©: ì˜¤í–‰ ë³´ì™„ì„ í†µí•œ ê±°ë¶€ê° í•´ì†Œ ì „ëµ
     ì˜ˆ: ìˆ˜(æ°´) ë¶€ì¡±ìœ¼ë¡œ ì˜ì–´ê°€ ì•½í•˜ë©´ â†’
         ë¬¼ ê¸°ìš´ ë³´ê°•: íŒŒë€ìƒ‰ í•„ê¸°êµ¬ ì‚¬ìš©, ì €ë… ì‹œê°„ëŒ€ í•™ìŠµ,
         ìŒì•… ë“¤ìœ¼ë©° ê³µë¶€, ìœ ì—°í•œ í•™ìŠµ ë°©ì‹(ë‹¤ì–‘í•œ êµì¬ ë¡œí…Œì´ì…˜)
   â”€ ê° ì•½ì  ê³¼ëª©ë‹¹ êµ¬ì²´ì  í–‰ë™ ì§€ì¹¨ 3ê°€ì§€

4. í•˜ë£¨ ì‹œê°„í‘œ ì„¤ê³„ (ì˜¤í–‰ ì‹œê°„ëŒ€ ê¸°ë°˜)
   â”€ 12ì§€ì§€ ì‹œê°„ëŒ€ë³„ ì—ë„ˆì§€ íŠ¹ì„±ê³¼ í•™ìƒ ì‚¬ì£¼ì˜ ê¶í•© ë¶„ì„
   â”€ ê³¼ëª©ë³„ ìµœì  í•™ìŠµ ì‹œê°„ ë°°ì¹˜í‘œ ì œì•ˆ
   â”€ ê³¼ëª© ì „í™˜ ì‹œ ë‡Œ ë¦¬ì…‹ì„ ìœ„í•œ ì˜¤í–‰ ì „í™˜ íŒ
     (ì˜ˆ: ìˆ˜í•™â†’êµ­ì–´ ì „í™˜ ì‹œ ê¸ˆâ†’ëª© ì „í™˜ = ì ê¹ ìŠ¤íŠ¸ë ˆì¹­)

5. ì‹œí—˜ ì£¼ê°„ ì „ëµ
   â”€ ì‹œí—˜ 2ì£¼ ì „: ê³¼ëª©ë³„ ìš°ì„ ìˆœìœ„ ë°°ì¹˜ (íˆ¬ì ëŒ€ë¹„ íš¨ìœ¨ ê¸°ì¤€)
   â”€ ì‹œí—˜ 1ì£¼ ì „: ì˜¤í–‰ ë°¸ëŸ°ìŠ¤ ìƒí™œ ë£¨í‹´
   â”€ ì‹œí—˜ ë‹¹ì¼: ê³¼ëª© ìˆœì„œë³„ ì—ë„ˆì§€ ì „í™˜ íŒ
   â”€ ì‹œí—˜ ì‚¬ì´ ì‰¬ëŠ” ì‹œê°„ í™œìš©ë²•

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[í†¤ & ì£¼ì˜ì‚¬í•­]
â€¢ "ì´ ê³¼ëª©ì€ ì•ˆ ë§ëŠ”ë‹¤"ê°€ ì•„ë‹Œ
  "ë‹¤ë¥¸ ì ‘ê·¼ë²•ì´ í•„ìš”í•œ ê³¼ëª©"ìœ¼ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.
â€¢ ì–´ë–¤ ê³¼ëª©ë„ í¬ê¸°í•˜ì§€ ì•Šë„ë¡ ë™ê¸°ë¥¼ ë¶€ì—¬í•˜ë˜,
  ì „ëµì  ì‹œê°„ ë°°ë¶„ì˜ í˜„ì‹¤ì„±ë„ í•¨ê»˜ ì œì‹œí•©ë‹ˆë‹¤.
â€¢ êµ¬ì²´ì ì¸ í–‰ë™ìœ¼ë¡œ ì—°ê²°ë˜ì§€ ì•ŠëŠ” ì¶”ìƒì  ì¡°ì–¸ì€ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
â€¢ ê³¼ëª©ë³„ ì „ëµì€ ì‹¤ì œ í•™êµ ìˆ˜ì—…Â·ì‹œí—˜ ìƒí™©ì— ì ìš© ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤.
â€¢ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
`.trim(), additionalRequest),
  },
}

// ---------------------------------------------------------------------------
// í—¬í¼ í•¨ìˆ˜
// ---------------------------------------------------------------------------

/** í”„ë¡¬í”„íŠ¸ ì˜µì…˜ ëª©ë¡ (UI ë“œë¡­ë‹¤ìš´ìš©) */
export function getPromptOptions(): AnalysisPromptMeta[] {
  return Object.values(PROMPT_DEFINITIONS).map((d) => d.meta)
}

/** IDë¡œ í”„ë¡¬í”„íŠ¸ ì •ì˜ ì¡°íšŒ */
export function getPromptDefinition(id: AnalysisPromptId): AnalysisPromptDefinition {
  return PROMPT_DEFINITIONS[id] ?? PROMPT_DEFINITIONS.default
}

/**
 * DB í”„ë¦¬ì…‹ í…œí”Œë¦¿ìœ¼ë¡œë¶€í„° í”„ë¡¬í”„íŠ¸ë¥¼ ë¹Œë“œí•©ë‹ˆë‹¤.
 * í…œí”Œë¦¿ ë‚´ {í•™ìƒì •ë³´}, {ì‚¬ì£¼ë°ì´í„°} í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì‹¤ì œ ê°’ìœ¼ë¡œ ì¹˜í™˜í•©ë‹ˆë‹¤.
 */
export function buildPromptFromTemplate(
  template: string,
  sajuResult: SajuResult,
  studentInfo?: StudentInfo,
  additionalRequest?: string,
): string {
  const filled = template
    .replaceAll("{í•™ìƒì •ë³´}", formatStudentInfo(studentInfo))
    .replaceAll("{ì‚¬ì£¼ë°ì´í„°}", formatSajuData(sajuResult))
  return appendAdditionalRequest(filled.trim(), additionalRequest)
}

/**
 * DB seedìš©: ì½”ë“œ ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ì˜ ë©”íƒ€ + í…œí”Œë¦¿ ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
 * ê° í”„ë¡¬í”„íŠ¸ì˜ buildPromptì—ì„œ ì‚¬ìš©í•˜ëŠ” í…œí”Œë¦¿ì„ {í•™ìƒì •ë³´}, {ì‚¬ì£¼ë°ì´í„°} í”Œë ˆì´ìŠ¤í™€ë” ë°©ì‹ìœ¼ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤.
 */
export function getBuiltInSeedData(): Array<{
  analysisType: "saju"
  promptKey: string
  name: string
  shortDescription: string
  target: string
  levels: string
  purpose: string
  recommendedTiming: string
  tags: string[]
  promptTemplate: string
  sortOrder: number
}> {
  // default í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (SAJU_INTERPRETATION_PROMPT ê¸°ë°˜)
  const defaultTemplate = `ì—­í• :
ë„ˆëŠ” í•œêµ­ ì „í†µ ì‚¬ì£¼ëª…ë¦¬í•™ ì „ë¬¸ê°€ì•¼. ì•„ë˜ ì‚¬ì£¼ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•™ìƒì—ê²Œ ë„ì›€ì´ ë˜ëŠ” í•´ì„ì„ ì œê³µí•´ì¤˜.

[í•™ìƒ ì •ë³´]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{í•™ìƒì •ë³´}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[í•™ìƒ ì‚¬ì£¼ ë°ì´í„°]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{ì‚¬ì£¼ë°ì´í„°}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ë‹¤ìŒ í•­ëª©ì„ í¬í•¨í•˜ì—¬ í•´ì„í•´ì£¼ì„¸ìš”:

1. **ì¼ì£¼ ë¶„ì„**: ì¼ê°„(æ—¥å¹²)ì˜ íŠ¹ì„±ê³¼ ê¸°ë³¸ ì„±ê²©
2. **ì˜¤í–‰ ê· í˜•**: ê°•í•œ ì˜¤í–‰ê³¼ ë¶€ì¡±í•œ ì˜¤í–‰, ê·¸ì— ë”°ë¥¸ ì„±í–¥
3. **ì‹­ì„± í•´ì„**: ì‹­ì„± ê´€ê³„ê°€ ë‚˜íƒ€ë‚´ëŠ” ëŒ€ì¸ê´€ê³„ ë° ì ì„±
4. **í•™ì—…/ì§„ë¡œ**: ì‚¬ì£¼ì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í•™ì—… ì ì„±ê³¼ ì§„ë¡œ ë°©í–¥
5. **ì¢…í•© ì¡°ì–¸**: í•™ìƒì—ê²Œ ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ê²©ë ¤ì˜ ë§

**ì¤‘ìš”:**
- ê³¼í•™ì  ê·¼ê±°ê°€ ì—†ëŠ” ì „í†µ í•´ì„ì„ì„ ëª…ì‹œ
- ê¸ì •ì ì´ê³  ê²©ë ¤í•˜ëŠ” í†¤ ìœ ì§€
- í•™ìƒì˜ ìì¡´ê°ì„ í•´ì¹  ìˆ˜ ìˆëŠ” ë‚´ìš© ì œì™¸
- ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±`

  // ë‚˜ë¨¸ì§€ í”„ë¡¬í”„íŠ¸: buildPrompt í•¨ìˆ˜ì—ì„œ ì‹¤ì œ í…œí”Œë¦¿ ì¶”ì¶œ
  // ë”ë¯¸ ë°ì´í„°ë¡œ í˜¸ì¶œ í›„ {í•™ìƒì •ë³´}, {ì‚¬ì£¼ë°ì´í„°}ë¥¼ ë‹¤ì‹œ í”Œë ˆì´ìŠ¤í™€ë”ë¡œ ì¹˜í™˜
  const STUDENT_PLACEHOLDER = "{í•™ìƒì •ë³´}"
  const SAJU_PLACEHOLDER = "{ì‚¬ì£¼ë°ì´í„°}"

  const dummyStudent: StudentInfo = {
    birthDate: "___BIRTH_DATE___",
    birthTime: "___BIRTH_TIME___",
  }
  const dummySaju: SajuResult = {
    pillars: {
      year: { stem: "ê°‘", branch: "ì" },
      month: { stem: "ë³‘", branch: "ì¸" },
      day: { stem: "ë¬´", branch: "ì˜¤" },
      hour: { stem: "ê²½", branch: "ì‹ " },
    },
    elements: { "ëª©": 2, "í™”": 3, "í† ": 1, "ê¸ˆ": 1, "ìˆ˜": 1 },
    tenGods: { year: "í¸ì¬", month: "í¸ì¸", hour: "ì‹ì‹ " },
    meta: {
      solarYear: 2008, solarTerm: "ì†Œí•œ", solarTermIndex: 0,
      monthIndex: 0, dayIndex: 0, timeKnown: true,
      kstTimestamp: "", correctedTimestamp: "", longitude: 127.0,
      solarCorrectionMinutes: 0, dstAdjusted: false,
    },
  }

  const dummyStudentStr = formatStudentInfo(dummyStudent)
  const dummySajuStr = formatSajuData(dummySaju)

  function extractTemplate(id: AnalysisPromptId): string {
    if (id === "default") return defaultTemplate
    const rendered = PROMPT_DEFINITIONS[id].buildPrompt(dummySaju, dummyStudent)
    return rendered
      .replaceAll(dummyStudentStr, STUDENT_PLACEHOLDER)
      .replaceAll(dummySajuStr, SAJU_PLACEHOLDER)
  }

  const ids: AnalysisPromptId[] = ["default", "learning-dna", "exam-slump", "career-navi", "mental-energy", "subject-strategy"]
  return ids.map((id, index) => {
    const meta = PROMPT_DEFINITIONS[id].meta
    return {
      analysisType: "saju" as const,
      promptKey: id,
      name: meta.name,
      shortDescription: meta.shortDescription,
      target: meta.target,
      levels: meta.levels,
      purpose: meta.purpose,
      recommendedTiming: meta.recommendedTiming,
      tags: meta.tags,
      promptTemplate: extractTemplate(id),
      sortOrder: index,
    }
  })
}

/** ìƒ˜í”Œ ë°ì´í„° (ë¯¸ë¦¬ë³´ê¸°ìš©) */
const SAMPLE_SAJU: SajuResult = {
  pillars: {
    year: { stem: "ê°‘", branch: "ì" },
    month: { stem: "ë³‘", branch: "ì¸" },
    day: { stem: "ë¬´", branch: "ì˜¤" },
    hour: { stem: "ê²½", branch: "ì‹ " },
  },
  elements: { "ëª©": 2, "í™”": 3, "í† ": 1, "ê¸ˆ": 1, "ìˆ˜": 1 },
  tenGods: { year: "í¸ì¬", month: "í¸ì¸", hour: "ì‹ì‹ " },
  meta: {
    solarYear: 2008, solarTerm: "ì†Œí•œ", solarTermIndex: 0,
    monthIndex: 0, dayIndex: 0, timeKnown: true,
    kstTimestamp: "2008-01-10T06:30:00+09:00",
    correctedTimestamp: "2008-01-10T06:30:00+09:00",
    longitude: 127.0, solarCorrectionMinutes: 0, dstAdjusted: false,
  },
}
const SAMPLE_STUDENT: StudentInfo = {
  birthDate: "2008-01-10",
  birthTime: "06:30",
  gender: "ë‚¨",
  grade: 11,
  school: "OOê³ ë“±í•™êµ",
}

/** í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸° í…ìŠ¤íŠ¸ (ìƒ˜í”Œ ì‚¬ì£¼ ë°ì´í„° ì ìš©) -- ì½”ë“œ ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ìš© */
export function getPromptPreviewText(id: AnalysisPromptId): string {
  return getPromptDefinition(id).buildPrompt(SAMPLE_SAJU, SAMPLE_STUDENT)
}

/** DB í…œí”Œë¦¿ ê¸°ë°˜ ë¯¸ë¦¬ë³´ê¸° í…ìŠ¤íŠ¸ */
export function getTemplatePreviewText(template: string): string {
  return buildPromptFromTemplate(template, SAMPLE_SAJU, SAMPLE_STUDENT)
}
